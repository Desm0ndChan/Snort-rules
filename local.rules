#Kerbrute user enum
alert tcp any any -> $HOME_NET 88 (msg:"Kerbrute User Enumeration Detected"; content:"AS-REQ"; content:"KRB5KDC_ERR_PREAUTH_REQUIRED"; content:"samAccountName"; sid:1000002; rev:1;)
#Kerbrute Password spray
alert tcp any any -> $HOME_NET 88 (msg:"Kerbrute Password Spray Detected"; content:"AS-REQ"; content:"KRB5KDC_ERR_PREAUTH_REQUIRED"; content:"password"; sid:1000003; rev:1;)
#Kerberoast
alert tcp any any -> $HOME_NET 88 (msg:"Kerberoast Attack Detected"; content:"KRB5KDC_ERR_PREAUTH_REQUIRED"; content:"servicePrincipalName"; sid:1000004; rev:1;)
# Reflective icmp flood
alert icmp any any -> $HOME_NET any (msg:"Reflective Ping Flood Detected";\
    icode:0;\
    threshold: type both, track by_src, count 10, seconds 1;\
    sid:1000005; rev:1;)
# Crafted packet from other private subnet
alert ip 192.168.0.0/16 any -> $HOME_NET any (msg:"Crafted Packet from 192.168.X.X Subnet Detected"; sid:1000006; rev:1;)
# SSH Bruteforce attempt
alert tcp any any -> $HOME_NET 22 (msg:"SSH Bruteforce Attempt Detected"; flow:to_server,established; content:"SSH-"; content:"PasswordAuthentication"; content:"Authentication failure"; sid:1000007; rev:1;)
# command injection request
alert tcp any any -> $HOME_NET 8080 (msg:"Command injection detected in POST request";\
    flow:from_client,established;\ 
    content:"POST"; http_method;\
    content="ping";http_uri;\
    content:"="; http_client_body;\
    pcre:"/[\;\|\&\`]/";\
    nocase;sid:1000002; rev:2;)
# Anonymous smb
alert tcp any any -> $HOME_NET 445 (msg:"SMB Anonymous Login Attempt Detected"; flow:to_server,established; content:"|00 00 00 00 00 00 00 00|"; content:"|FF|SMB"; content:"|72 00 00 00|"; content:"|00 00 00 00|"; content:"|00 00 00 00|"; content:"|00 00 00 00|"; content:"|00 00 00 00|"; content:"|00 00 00 00|"; sid:1000009; rev:1;)
# msfvenom enternal blue
alert tcp any any -> $HOME_NET any (msg:"MSFVenom Eternal Blue Exploit Detected"; flow:to_server,established; content:"|4d 53 46 54 20 30 30 00 00 00 00 00 00 00 01 06|"; content:"|2e 00 00 00|"; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; content:"|00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00|"; sid:1000010; rev:1;) 